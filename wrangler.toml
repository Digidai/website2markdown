name = "website2markdown"
main = "src/index.ts"
compatibility_date = "2025-02-14"
compatibility_flags = ["nodejs_compat"]

[browser]
binding = "MYBROWSER"

# KV namespace for caching converted markdown
[[kv_namespaces]]
binding = "CACHE_KV"
id = "ce411570e9734bae989e03c705804c94"

# R2 bucket for storing images
[[r2_buckets]]
binding = "IMAGE_BUCKET"
bucket_name = "md-images"

[observability]
enabled = true

# Built-in Worker code applies per-IP limits when cf-connecting-ip is present.
# Keep Cloudflare WAF rate limiting enabled as an outer layer.

# Secrets (set via wrangler secret):
# API_TOKEN — Bearer token for POST /api/batch authentication
# PUBLIC_API_TOKEN — optional token for raw API + /api/stream
# PAYWALL_RULES_JSON — optional JSON array of runtime paywall rules
# Optional var:
# PAYWALL_RULES_KV_KEY — KV key name containing JSON paywall rules (overrides PAYWALL_RULES_JSON)

# Custom domain configuration — update with your actual domain
# routes = [
#   { pattern = "your-domain.example.com/*", zone_name = "example.com" }
# ]
